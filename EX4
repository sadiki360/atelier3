
#include <iostream>
#include <string>
#include <list>
#include <iomanip> 

class Compte; 

// --- 1. Classe Client ---

class Client {
private:
    int id;
    std::string nom;
    std::string prenom;

public:
    // 1. Définir les constructeurs nécessaires

    // Constructeur 1 : Création d'un client vide
    Client() : id(0), nom(""), prenom("") {
        std::cout << "Client() - Client par defaut cree." << std::endl;
    }

    // Constructeur 2 : Création d'un client avec valeurs initiales
    Client(int _id, const std::string& _nom, const std::string& _prenom)
        : id(_id), nom(_nom), prenom(_prenom) {
        std::cout << "Client(int, string, string) - Client " << nom << " cree." << std::endl;
    }

    // Constructeur 3 : Copie d'un client existant (copie superficielle/profonde via std::string)
    Client(const Client& autre)
        : id(autre.id), nom(autre.nom), prenom(autre.prenom) {
        std::cout << "Client(const Client&) - Copie de client creee (Copie des attributs par defaut)." << std::endl;
        // La copie superficielle est suffisante ici car std::string gère déjà sa propre mémoire (copie profonde)
    }

    // 2. Ajouter un destructeur adapté
    // Attention: faut-il une copie profonde ou superficielle? (voir note plus haut)
    // Le destructeur est-il indispensable? Pas techniquement, car std::string a son propre destructeur
    // et il n'y a pas d'allocation de mémoire brute. Mais on l'ajoute par bonne pratique.
    ~Client() {
        std::cout << "~Client() - Client " << nom << " detruit." << std::endl;
    }

    // 3. Créer une méthode pour afficher les informations d'un client
    void afficherInfos() const {
        std::cout << "\n--- Infos Client ---" << std::endl;
        std::cout << "ID: " << id << std::endl;
        std::cout << "Nom: " << nom << std::endl;
        std::cout << "Prenom: " << prenom << std::endl;
        std::cout << "--------------------" << std::endl;
    }

    // Accesseur pour l'ID (utile pour les comptes)
    int getId() const { return id; }
};

// --- 2. Classe Compte ---

class Compte {
private:
    int numero;
    float solde;
    Client* client; // Pointeur vers un objet Client (pas le propriétaire)
    static int nbComptes; // Attribut partagé (static)

public:
    // Constructeur sans paramètre
    Compte() : numero(0), solde(0.0f), client(nullptr) {
        nbComptes++;
        std::cout << "Compte() - Compte par defaut cree. Total comptes: " << nbComptes << std::endl;
    }

    // Constructeur avec paramètres
    Compte(int num, float s, Client* cl) : numero(num), solde(s), client(cl) {
        nbComptes++;
        std::cout << "Compte(int, float, Client*) - Compte " << numero << " cree. Total comptes: " << nbComptes << std::endl;
    }

    // Constructeur de copie
    Compte(const Compte& autre) 
        : numero(autre.numero), solde(autre.solde), client(autre.client) {
        // Le Compte copié partage le même pointeur Client et le même numéro (pour l'exercice)
        // NOTE: En production, il faudrait decider si le client doit etre copie ou non.
        nbComptes++; // Chaque copie est un nouveau compte ouvert
        std::cout << "Compte(const Compte&) - Copie de Compte " << numero << " creee. Total comptes: " << nbComptes << std::endl;
    }
    
    // Destructeur
    ~Compte() {
        nbComptes--;
        std::cout << "~Compte() - Compte " << numero << " detruit. Total comptes restants: " << nbComptes << std::endl;
    }

    // Méthode pour afficher les informations d'un compte
    void afficherInfos() const {
        std::cout << "\n--- Infos Compte ---" << std::endl;
        std::cout << "Numero de compte: " << numero << std::endl;
        std::cout << "Solde: " << std::fixed << std::setprecision(2) << solde << " EUR" << std::endl;
        if (client) {
            std::cout << "Proprietaire (ID): " << client->getId() << std::endl;
        } else {
            std::cout << "Aucun proprietaire associe." << std::endl;
        }
        std::cout << "Total Comptes Ouverts: " << nbComptes << std::endl;
        std::cout << "----------------------" << std::endl;
    }
    
};

// Initialisation de l'attribut statique partagé
int Compte::nbComptes = 0;


int main() {
    // Creation de clients
    Client c1(1, "Dupont", "Jean");
    Client c2(2, "Durand", "Marie");
    Client c_copie = c1; // Test du constructeur de copie Client

    c1.afficherInfos();
    c_copie.afficherInfos();

    std::cout << "\n--- Gestion Comptes ---\n" << std::endl;

    // Creation de comptes
    Compte compte_defaut; // Test du constructeur par defaut
    Compte compte_jean(101, 1500.50f, &c1); // Compte de Jean
    Compte compte_marie(102, 500.00f, &c2); // Compte de Marie

    // Copie de compte
    Compte compte_copie = compte_jean; // Test du constructeur de copie Compte

    compte_jean.afficherInfos();
    compte_marie.afficherInfos();
    compte_copie.afficherInfos();

    // Suivre le nombre total de comptes existants
    std::cout << "\nNombre total de comptes (via methode statique): " << Compte::getTotalComptes() << std::endl;

    // Calculer des interets
    compte_jean.calculerInterets(0.02f); // 2% d'interet

    // Afficher la liste des comptes et clients (non implemente completement ici)
    
    std::cout << "\n--- Fin du programme ---\n" << std::endl;


    return 0;
}

